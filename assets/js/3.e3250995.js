(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{52:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"通过travisci自动化部署vuepress到githubpages"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过travisci自动化部署vuepress到githubpages","aria-hidden":"true"}},[t._v("#")]),t._v(" 通过TravisCI自动化部署VuePress到GithubPages")]),a("p",[t._v("这篇文章主要介绍部署"),a("a",{attrs:{href:"https://vuepress.vuejs.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuepress")]),t._v("到"),a("a",{attrs:{href:"https://travis-ci.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("travis-ci")]),t._v("上，方便自动化发布文章。")]),a("blockquote",[a("p",[t._v("VuePress is composed of two parts: a minimalistic static site generator with a Vue-powered theming system, and a default theme optimized for writing technical documentation. It was created to support the documentation needs of Vue's own sub projects.")])]),a("p",[a("a",{attrs:{href:"https://vuepress.vuejs.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuepress")]),t._v("是一个由"),a("a",{attrs:{href:"https://vuejs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuejs")]),t._v("驱动的静态网站生成系统。默认带有一个为编写技术文档优化的主题。所以我们可以用它来代替类似Hexo等静态网站系统，并且能通过vue带来更多有用的特性，具体内容请去"),a("a",{attrs:{href:"https://vuepress.vuejs.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuepress")]),t._v("官网查看。")]),a("h2",{attrs:{id:"安装vuepress"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装vuepress","aria-hidden":"true"}},[t._v("#")]),t._v(" 安装VuePress")]),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),a("p",[t._v("VuePress需要Node.js 版本>=8。")])]),a("h3",{attrs:{id:"全局安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全局安装","aria-hidden":"true"}},[t._v("#")]),t._v(" 全局安装")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("# 全局安装")]),t._v("\nyarn global add vuepress "),a("span",{attrs:{class:"token comment"}},[t._v("# OR npm install -g vuepress")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 创建md文件")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'# Hello VuePress'")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" README.md\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 启动服务器")]),t._v("\nvuepress dev\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 编译成静态文件")]),t._v("\nvuepress build\n")])]),a("h3",{attrs:{id:"本地安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本地安装","aria-hidden":"true"}},[t._v("#")]),t._v(" 本地安装")]),a("p",[t._v("如果用于项目文档，需要把VuePress安装到本地项目目录。由于本文目的是用于静态博客，所以从建目录开始。")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("#创建项目目录")]),t._v("\n"),a("span",{attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" vue-press-blog\n\n"),a("span",{attrs:{class:"token function"}},[t._v("cd")]),t._v(" vue-press-blog\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("#安装vuepress")]),t._v("\nyarn add -D vuepress "),a("span",{attrs:{class:"token comment"}},[t._v("# or npm install -D vuepress")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("#创建sources目录")]),t._v("\n"),a("span",{attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" sources\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'# Hello VuePress'")]),a("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" sources/README.md\n")])]),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("警告")]),a("p",[t._v("如果在已经存在的项目中使用了webpack 3.x依赖，推荐使用"),a("a",{attrs:{href:"https://yarnpkg.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("yarn")]),t._v("\n安装依赖，npm安装的话依赖树无法正确生成。")])]),a("p",[t._v("然后添加下面的内容到"),a("code",[t._v("package.json")]),t._v("文件中：")]),a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{attrs:{class:"highlighted-line"}},[t._v("    "),a("span",{attrs:{class:"token property"}},[t._v('"blog:dev"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"vuepress dev sources"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")])]),a("span",{attrs:{class:"highlighted-line"}},[t._v("    "),a("span",{attrs:{class:"token property"}},[t._v('"blog:build"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"vuepress build sources"')])]),t._v("  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("p",[t._v("高亮行的"),a("code",[t._v("blog:dev")]),t._v("是可以自定义的，"),a("code",[t._v("sources")]),t._v("代表md文件的目录，也可以自定义，只要有对应的目录就可以。")]),a("p",[t._v("现在可以运行刚添加的命令，开始编写md文件，同时在浏览器中预览效果，VuePress会自动加载更改的文件。")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("yarn blog:dev "),a("span",{attrs:{class:"token comment"}},[t._v("# or npm run blog:dev")]),t._v("\n")])]),a("p",[t._v("如果要生成静态页面，可以运行：")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("yarn blog:build "),a("span",{attrs:{class:"token comment"}},[t._v("# or npm run blog:build")]),t._v("\n")])]),a("p",[t._v("静态页面默认在"),a("code",[t._v("sources/.vuepress/dist/")]),t._v("目录下,可以通过"),a("code",[t._v(".vuepress/config.js")]),t._v("文件base字段自定义配置。生成的静态文件可以放到任意server上。")]),a("h2",{attrs:{id:"配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置")]),a("p",[t._v("新建配置文件"),a("code",[t._v("config.js")]),t._v("在"),a("code",[t._v(".vuepress/")]),t._v("目录下，更多配置信息参考"),a("a",{attrs:{href:"https://vuepress.vuejs.org/guide/basic-config.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuepress官网")])]),a("h2",{attrs:{id:"资源文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#资源文件","aria-hidden":"true"}},[t._v("#")]),t._v(" 资源文件")]),a("p",[t._v("新建资源文件目录"),a("code",[t._v(".vuepress/public")]),t._v("，这个目录下的文件在"),a("code",[t._v("vuepress build")]),t._v("时会复制到"),a("code",[t._v("dist")]),t._v("根目录下。")]),a("h3",{attrs:{id:"base-url"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#base-url","aria-hidden":"true"}},[t._v("#")]),t._v(" Base URL")]),a("p",[t._v("本文要把vuepress部署到github page上，需要定义"),a("code",[t._v("base")]),t._v("变量，为了正确引用资源文件。不在github page上部署的话，不需要理会。")]),a("p",[t._v("如果部署在"),a("code",[t._v("https://{your-github-name}.github.io")]),t._v("地址上,不需要配置。要是类似"),a("code",[t._v("https://{your-github-name}.github.io/{repo-name}/")]),t._v("地址上，需要在"),a("code",[t._v("config.js")]),t._v("中定义"),a("code",[t._v("base")]),t._v("的值为"),a("code",[t._v("/{repo-name}/")]),t._v("。")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("//config.js")]),t._v("\nmodule"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{attrs:{class:"highlighted-line"}},[t._v("    base"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token string"}},[t._v("'/vue-press-blog/'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")])]),t._v("    title"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token string"}},[t._v("'Mybrc91\\'s Site'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    description"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token string"}},[t._v("'Just A Tech Site.'")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("h2",{attrs:{id:"在github-page上部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在github-page上部署","aria-hidden":"true"}},[t._v("#")]),t._v(" 在Github Page上部署")]),a("h3",{attrs:{id:"初始化github仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化github仓库","aria-hidden":"true"}},[t._v("#")]),t._v(" 初始化github仓库")]),a("h4",{attrs:{id:"创建仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建仓库","aria-hidden":"true"}},[t._v("#")]),t._v(" 创建仓库")]),a("ol",[a("li",[t._v("如果要部署到"),a("code",[t._v("https://{your-github-name}.github.io")]),t._v("地址上，需要创建以"),a("code",[t._v("{your-github-name}.github.io")]),t._v("为名字的仓库")]),a("li",[t._v("如果部署到"),a("code",[t._v("https://{your-github-name}.github.io/{repo-name}/")]),t._v("地址上，要创建"),a("code",[t._v("{repo-name}")]),t._v("仓库。")])]),a("p",[t._v("本文是第二种，创建了"),a("code",[t._v("vue-press-blog")]),t._v("仓库。")]),a("h4",{attrs:{id:"部署源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署源码","aria-hidden":"true"}},[t._v("#")]),t._v(" 部署源码")]),a("p",[t._v("在根目录下创建忽略文件"),a("code",[t._v(".gitginore")]),t._v("，填入如下内容。高亮行可以根据情况修改，不需要把生成的静态文件提交到github上：")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v(".DS_Store\nThumbs.db\ndb.json\n*.log\nnode_modules/\n"),a("span",{attrs:{class:"highlighted-line"}},[t._v("sources/.vuepress/dist/")]),t._v("*.bat\n*.sh\n")])]),a("p",[t._v("在根目录创建"),a("code",[t._v("deploy.sh")]),t._v("，填入以下内容:")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("#!/usr/bin/env sh")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 发生错误时停止")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("set")]),t._v(" -e\n\n"),a("span",{attrs:{class:"token function"}},[t._v("git")]),t._v(" init\n"),a("span",{attrs:{class:"token function"}},[t._v("git")]),t._v(" add -A\n"),a("span",{attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -m "),a("span",{attrs:{class:"token string"}},[t._v("'init'")]),t._v("\n\n"),a("span",{attrs:{class:"token function"}},[t._v("git")]),t._v(" config --local user.name "),a("span",{attrs:{class:"token string"}},[t._v('"{name}"')]),t._v("\n"),a("span",{attrs:{class:"token function"}},[t._v("git")]),t._v(" config --local user.email "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("email"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 如果部署到 https://{USERNAME}.github.io")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("# git push -f git@github.com:{USERNAME}/{USERNAME}.github.io.git master:{branch-name}")]),t._v("\n\n"),a("span",{attrs:{class:"token comment"}},[t._v("# 如果部署到 https://{USERNAME}.github.io/{REPO}")]),t._v("\n"),a("span",{attrs:{class:"token comment"}},[t._v("#git push -f git@github.com:{USERNAME}/{REPO}.git master")]),t._v("\n\n"),a("span",{attrs:{class:"token function"}},[t._v("cd")]),t._v(" -\n")])]),a("p",[t._v("运行命令"),a("code",[t._v(". deploy.sh")]),t._v(",把源码提交到github上。")]),a("h3",{attrs:{id:"配置tracisci"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置tracisci","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置TracisCI")]),a("h4",{attrs:{id:"创建配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建配置文件","aria-hidden":"true"}},[t._v("#")]),t._v(" 创建配置文件")]),a("p",[t._v("在项目根目录下创建travis-ci的配置文件"),a("code",[t._v(".travis.yml")]),t._v("，travis-ci根据这个文件自动编译部署。")]),a("p",[t._v("配置如下，注意高亮行，需要使用lts版本的nodejs：")]),a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{attrs:{class:"token key atrule"}},[t._v("language")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" node_js\n"),a("span",{attrs:{class:"token key atrule"}},[t._v("node_js")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{attrs:{class:"highlighted-line"}},[t._v("  "),a("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"lts/*"')])]),a("span",{attrs:{class:"token key atrule"}},[t._v("branches")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{attrs:{class:"token key atrule"}},[t._v("only")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" master\n\n"),a("span",{attrs:{class:"token key atrule"}},[t._v("cache")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{attrs:{class:"token key atrule"}},[t._v("directories")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node_modules\n  "),a("span",{attrs:{class:"token key atrule"}},[t._v("yarn")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n\n"),a("span",{attrs:{class:"token key atrule"}},[t._v("before_install")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" export TZ='Asia/Shanghai'  "),a("span",{attrs:{class:"token comment"}},[t._v("# 设置时区")]),t._v("\n\n"),a("span",{attrs:{class:"token key atrule"}},[t._v("install")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" yarn\n\n"),a("span",{attrs:{class:"token key atrule"}},[t._v("script")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" yarn blog"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("build\n\n"),a("span",{attrs:{class:"token key atrule"}},[t._v("deploy")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{attrs:{class:"token key atrule"}},[t._v("provider")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pages\n  "),a("span",{attrs:{class:"token key atrule"}},[t._v("skip-cleanup")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),a("span",{attrs:{class:"token key atrule"}},[t._v("github-token")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $GITHUB_TOKEN\n  "),a("span",{attrs:{class:"token key atrule"}},[t._v("local-dir")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./sources/.vuepress/dist/ "),a("span",{attrs:{class:"token comment"}},[t._v("## 根据情况自定义到静态文件输出目录")]),t._v("\n  "),a("span",{attrs:{class:"token key atrule"}},[t._v("target-branch")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gh"),a("span",{attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages\n  "),a("span",{attrs:{class:"token key atrule"}},[t._v("verbose")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),a("span",{attrs:{class:"token key atrule"}},[t._v("on")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{attrs:{class:"token key atrule"}},[t._v("branch")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" master\n\n")])]),a("h4",{attrs:{id:"设置travis-ci-org"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置travis-ci-org","aria-hidden":"true"}},[t._v("#")]),t._v(" 设置travis-ci.org")]),a("ol",[a("li",[t._v("首先获取从github网站获取GITHUB_TOKEN。登录github，打开"),a("a",{attrs:{href:"https://github.com/settings/tokens",target:"_blank",rel:"noopener noreferrer"}},[t._v("token")]),t._v(",点击"),a("code",[t._v("Generate new token")]),t._v(",根据提示创建token，选项一般都取默认值，最后获取到一个字符串token。")])]),a("p",[t._v("2 .假设已经会使用travis-ci，然后登录"),a("a",{attrs:{href:"https://travis-ci.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("travis-ci.org")]),t._v("，添加新建的仓库。打开仓库的"),a("code",[t._v("setting")]),t._v("项,在"),a("code",[t._v("Environment Variables")]),t._v("条目下添加"),a("code",[t._v("GITHUB_TOKEN")]),t._v("变量，变量值就是上一步获取到的token。")]),a("h4",{attrs:{id:"提交代码到github"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#提交代码到github","aria-hidden":"true"}},[t._v("#")]),t._v(" 提交代码到github")]),a("p",[t._v("在根目录输入以下命令：")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token function"}},[t._v("git")]),t._v(" init\n"),a("span",{attrs:{class:"token function"}},[t._v("git")]),t._v(" add -A\n"),a("span",{attrs:{class:"highlighted-line"}},[a("span",{attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -m "),a("span",{attrs:{class:"token string"}},[t._v("'{comment}'")])]),a("span",{attrs:{class:"token function"}},[t._v("git")]),t._v(" push -u "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("git地址"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" master\n")])]),a("p",[t._v("高亮行的"),a("code",[t._v("{comment}")]),t._v("替换成实际的提交评论，"),a("code",[t._v("{git 地址}")]),t._v("替换前面创建仓库的地址。")]),a("p",[t._v("travis-ci检测到项目的提交，就会根据"),a("code",[t._v(".travis.yml")]),t._v("文件去编译项目，最后把生成的静态文件推送到仓库的"),a("code",[t._v("gh-pages")]),t._v("分支，然后访问对应的目录就能看到生成的静态网站。本文生成的地址是"),a("a",{attrs:{href:"http://mybrc91.github.io/vue-press-blog",target:"_blank",rel:"noopener noreferrer"}},[t._v("mybrc91.github.io/vue-press-blog")]),t._v("。")]),a("p",[t._v("以后有新的改动，只需要执行最后一步提交代码的命令，travis-ci就会自动编译部署。")])])}],!1,null,null,null);s.default=n.exports}}]);